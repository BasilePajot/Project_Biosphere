# This file is a program that goes fetch the data on one taxa that is
#given to the file as a variable in the script_database_constitution.sh file

# Libraries

library(bold)
library(dbplyr)
library(tidyverse)

# Commands to get the taxa as a local variable usable in the code

order_done <- c()
ordres_fctpas <- c()
order <- c("Acanaloniidae",
"Acanthocnemidae",
"Acanthopteroctetidae",
"Acanthosomatidae",
"Acartophthalmidae",
"Achilidae",
"Aclerdidae",
"Acroceridae",
"Actinopodidae",
"Adelgidae",
"Adelidae",
"Aderidae",
"Aenictopecheidae",
"Aetalionidae",
"Agaonidae",
"Agathiphagidae",
"Agelenidae",
"Agromyzidae",
"Agyrtidae",
"Aididae",
"Akalyptoischiidae",
"Alexiidae",
"Aleyrodidae",
"Alucitidae",
"Alydidae",
"Amaurobiidae",
"Amblypygi",
"Ammoplanidae",
"Ammoxenidae",
"Amphientomidae",
"Amphipsocidae",
"Amphizoidae",
"Ampulicidae",
"Anamorphidae",
"Anapidae",
"Anaxyelidae",
"Andesianidae",
"Andrenidae",
"Anisopodidae",
"Anthelidae",
"Anthicidae",
"Anthocoridae",
"Anthomyiidae",
"Anthomyzidae",
"Anthribidae",
"Antrodiaetidae",
"Anyphaenidae",
"Apatelodidae",
"Aphalaridae",
"Aphelinidae",
"Aphelocheiridae",
"Aphididae",
"Aphrophoridae",
"Apidae",
"Apioceridae",
"Apsilocephalidae",
"Apystomyiidae",
"Aradidae",
"Araneidae",
"Archaeidae",
"Archaeognatha",
"Archeocrypticidae",
"Archipsocidae",
"Argidae",
"Argyresthiidae",
"Arkyidae",
"Artematopodidae",
"Artheneidae",
"Asilidae",
"Asiopsocidae",
"Aspidytidae",
"Astatidae",
"Asteiidae",
"Asterolecaniidae",
"Atelestidae",
"Athericidae",
"Atracidae",
"Attelabidae",
"Attevidae",
"Atypidae",
"Aulacidae",
"Aulacigastridae",
"Australimyzidae",
"Austrochilidae",
"Austroleptidae",
"Autostichidae",
"Axymyiidae",
"Azotidae",
"Barychelidae",
"Batrachedridae",
"Bedelliidae",
"Belidae",
"Belostomatidae",
"Bembicidae",
"Berytidae",
"Bethylidae",
"Bibionidae",
"Biphyllidae",
"Blasticotomidae",
"Blastobasidae",
"Blattodea",
"Blephariceridae",
"Blissidae",
"Boganiidae",
"Bolbomyiidae",
"Bolitophilidae",
"Bombycidae",
"Bombyliidae",
"Boopiidae",
"Boridae",
"Bostrichidae",
"Bothrideridae",
"Brachodidae",
"Brachystomatidae",
"Braconidae",
"Bradynobaenidae",
"Brahmaeidae",
"Brentidae",
"Bucculatricidae",
"Buprestidae",
"Byrrhidae",
"Byturidae",
"Caeciliusidae",
"Caliscelidae",
"Callidulidae",
"Calliphoridae",
"Callirhipidae",
"Calophyidae",
"Calopsocidae",
"Camillidae",
"Canacidae",
"Canopidae",
"Cantacaderidae",
"Cantharidae",
"Canthyloscelidae",
"Caponiidae",
"Carabidae",
"Caridae",
"Carnidae",
"Carposinidae",
"Carsidaridae",
"Carthaeidae",
"Castniidae",
"Cecidomyiidae",
"Cecidosidae",
"Celyphidae",
"Cephidae",
"Cerambycidae",
"Ceraphronidae",
"Ceratocombidae",
"Ceratopogonidae",
"Cercopidae",
"Cerococcidae",
"Cerophytidae",
"Cerylonidae",
"Chaetosomatidae",
"Chalcididae",
"Chamaemyiidae",
"Chaoboridae",
"Cheiracanthiidae",
"Chelonariidae",
"Chironomidae",
"Chloropidae",
"Choreutidae",
"Chrysididae",
"Chrysolampidae",
"Chrysomelidae",
"Chyphotidae",
"Chyromyidae",
"Cicadellidae",
"Cicadidae",
"Ciidae",
"Cimberididae",
"Cimbicidae",
"Cimeliidae",
"Cimicidae",
"Cithaeronidae",
"Cixiidae",
"Cladiopsocidae",
"Clambidae",
"Clastopteridae",
"Cleridae",
"Clubionidae",
"Clusiidae",
"Coccidae",
"Coccinellidae",
"Coelopidae",
"Coelostomidiidae",
"Coleophoridae",
"Colletidae",
"Colobathristidae",
"Compsocidae",
"Conchaspididae",
"Conopidae",
"Copromorphidae",
"Coreidae",
"Corethrellidae",
"Corinnidae",
"Corixidae",
"Corylophidae",
"Cosmopterigidae",
"Cossidae",
"Crabronidae",
"Crambidae",
"Cryptochetidae",
"Cryptococcidae",
"Cryptophagidae",
"Ctenidae",
"Ctenizidae",
"Ctenostylidae",
"Cucujidae",
"Culicidae",
"Cupedidae",
"Curculionidae",
"Curtonotidae",
"Cyatholipidae",
"Cybaeidae",
"Cybocephalidae",
"Cyclaxyridae",
"Cycloctenidae",
"Cyclotornidae",
"Cydnidae",
"Cylindrotomidae",
"Cymidae",
"Cynipidae",
"Cypselosomatidae",
"Cyrtaucheniidae",
"Cyrtocoridae",
"Dactylopiidae",
"Dalceridae",
"Dascillidae",
"Dasydemellidae",
"Deinopidae",
"Delphacidae",
"Depressariidae",
"Derbidae",
"Dermaptera",
"Dermestidae",
"Derodontidae",
"Desidae",
"Deuterophlebiidae",
"Diadocidiidae",
"Diapriidae",
"Diaspididae",
"Diastatidae",
"Dictynidae",
"Dictyopharidae",
"Diguetidae",
"Dinidoridae",
"Diopsidae",
"Dipluridae",
"Diprionidae",
"Dipsocoridae",
"Diptera_family_incertae_sedis",
"Discolomatidae",
"Disteniidae",
"Ditomyiidae",
"Dixidae",
"Doidae",
"Dolabellopsocidae",
"Dolichopodidae",
"Douglasiidae",
"Drepanidae",
"Drosophilidae",
"Dryadaulidae",
"Dryinidae",
"Drymusidae",
"Dryomyzidae",
"Dryopidae",
"Dudgeoneidae",
"Dysderidae",
"Dytiscidae",
"Echinophthiriidae",
"Ectopsocidae",
"Elachistidae",
"Elateridae",
"Elipsocidae",
"Elmidae",
"Embioptera",
"Embolemidae",
"Empididae",
"Encyrtidae",
"Endomychidae",
"Endromidae",
"Enicocephalidae",
"Epermeniidae",
"Ephemeroptera",
"Ephydridae",
"Epicopeiidae",
"Epimetopidae",
"Epipsocidae",
"Epipygidae",
"Epipyropidae",
"Erebidae",
"Eresidae",
"Eriaporidae",
"Eriococcidae",
"Eriocottidae",
"Eriocraniidae",
"Erotylidae",
"Eucharitidae",
"Eucinetidae",
"Eucnemidae",
"Euctenizidae",
"Eulichadidae",
"Eulophidae",
"Eupelmidae",
"Eupsilobiidae",
"Eupterotidae",
"Eurybrachidae",
"Eurytomidae",
"Euteliidae",
"Eutrichosomatidae",
"Euxestidae",
"Evaniidae",
"Evocoidae",
"Fanniidae",
"Fergusoninidae",
"Figitidae",
"Filistatidae",
"Flatidae",
"Formicidae",
"Fulgoridae",
"Galacticidae",
"Gallieniellidae",
"Gasteruptiidae",
"Gelastocoridae",
"Gelechiidae",
"Geocoridae",
"Geometridae",
"Georissidae",
"Geotrupidae",
"Gerridae",
"Glaphyridae",
"Glaresidae",
"Glossinidae",
"Glyphipterigidae",
"Gnaphosidae",
"Gobryidae",
"Gracillariidae",
"Gradungulidae",
"Gyrinidae",
"Haematomyzidae",
"Haematopinidae",
"Hahniidae",
"Halictidae",
"Haliplidae",
"Halonoproctidae",
"Hebridae",
"Hedylidae",
"Helcomyzidae",
"Heleomyzidae",
"Heliodinidae",
"Heliozelidae",
"Helophoridae",
"Heloridae",
"Helosciomyzidae",
"Helotidae",
"Helotrephidae",
"Hemipsocidae",
"Hepialidae",
"Heptamelidae",
"Hermatobatidae",
"Hersiliidae",
"Hesperiidae",
"Hesperinidae",
"Heterobathmiidae",
"Heteroceridae",
"Heterogastridae",
"Heterogynidae",
"Hexathelidae",
"Hilarimorphidae",
"Himantopteridae",
"Hippoboscidae",
"Histeridae",
"Hobartiidae",
"holothyrida",
"Homalocnemiidae",
"Homalonychidae",
"Homotomidae",
"Hoplopleuridae",
"Huttoniidae",
"Huttoninidae",
"Hyblaeidae",
"Hybosoridae",
"Hybotidae",
"Hydraenidae",
"Hydrochidae",
"Hydrometridae",
"Hydrophilidae",
"Hydroscaphidae",
"Hygrobiidae",
"Hypochilidae",
"Ibaliidae",
"Iberobaeniidae",
"Ichneumonidae",
"Idiopidae",
"Idiostolidae",
"Immidae",
"Inbiomyiidae",
"Incurvariidae",
"Ironomyiidae",
"Ischaliidae",
"Ismaridae",
"Issidae",
"Iteaphila-group",
"Ixodida",
"Joppeicidae",
"Jurasaidae",
"Kateretidae",
"Kermesidae",
"Keroplatidae",
"Kerriidae",
"Kinnaridae",
"Kuwaniidae",
"Lachesillidae",
"Lacturidae",
"Laemobothriidae",
"Laemophloeidae",
"Lamponidae",
"Lampyridae",
"Largidae",
"Lasiocampidae",
"Lasiochilidae",
"Latridiidae",
"Lauxaniidae",
"Lecithoceridae",
"Leiodidae",
"Lepiceridae",
"Lepidopsocidae",
"Lepidoptera_incertae_sedis",
"Leptonetidae",
"Leptopodidae",
"Lestoniidae",
"Leucospidae",
"Limacodidae",
"Limnichidae",
"Limoniidae",
"Linognathidae",
"Linyphiidae",
"Liocranidae",
"Liopteridae",
"Liphistiidae",
"Liposcelididae",
"Liviidae",
"Lonchaeidae",
"Lonchopteridae",
"Lophocateridae",
"Lophocoronidae",
"Lophopidae",
"Lucanidae",
"Lutrochidae",
"Lycaenidae",
"Lycidae",
"Lycosidae",
"Lyctocoridae",
"Lygaeidae",
"Lymexylidae",
"Lyonetiidae",
"Lypusidae",
"Maamingidae",
"Machaerotidae",
"Macrothelidae",
"Macroveliidae",
"Malcidae",
"Malkaridae",
"Mantodea",
"Marchalinidae",
"Margarodidae",
"Marginidae",
"Mauroniscidae",
"Mecoptera",
"Mecysmaucheniidae",
"Meenoplidae",
"Meessiidae",
"Megachilidae",
"Megadictynidae",
"Megalodontesidae",
"Megalopodidae",
"Megaloptera",
"Megalopygidae",
"Megalyridae",
"Megamerinidae",
"Megarididae",
"Megaspilidae",
"Megastigmidae",
"Melandryidae",
"Melittidae",
"Mellinidae",
"Meloidae",
"Melyridae",
"Membracidae",
"Menoponidae",
"Meruidae",
"Mesembrinellidae",
"Mesopsocidae",
"Mesostigmata",
"Mesoveliidae",
"Metarbelidae",
"Micromalthidae",
"Micropezidae",
"Microphysidae",
"Micropterigidae",
"Microthoraciidae",
"Migidae",
"Milichiidae",
"Millieriidae",
"Mimallonidae",
"Mimetidae",
"Miridae",
"Miturgidae",
"Mnesarchaeidae",
"Momphidae",
"Monomachidae",
"Monophlebidae",
"Monotomidae",
"Mordellidae",
"Murmidiidae",
"Musapsocidae",
"Muscidae",
"Mutillidae",
"Mycetaeidae",
"Mycetophagidae",
"Mycetophilidae",
"Mycteridae",
"Mydidae",
"Mymaridae",
"Mymarommatidae",
"Myopsocidae",
"Myraboliidae",
"Myrmecicultoridae",
"Myrmosidae",
"Mysmenidae",
"Mystacinobiidae",
"Nabidae",
"Nannodastiidae",
"Naucoridae",
"Nemesiidae",
"Nemestrinidae",
"Nemonychidae",
"Neopseustidae",
"Nepidae",
"Nepticulidae",
"Neriidae",
"Nesticidae",
"Neuroptera",
"Nicodamidae",
"Ninidae",
"Nitidulidae",
"Noctuidae",
"Nogodinidae",
"Nolidae",
"Nosodendridae",
"Noteridae",
"Nothybidae",
"Notodontidae",
"Notonectidae",
"Notoptera",
"Nymphalidae",
"Nymphomyiidae",
"Ochodaeidae",
"Ochteridae",
"Ochyroceratidae",
"Odiniidae",
"Odonata",
"Oecobiidae",
"Oecophoridae",
"Oedemeridae",
"Oenosandridae",
"Oestridae",
"Omethidae",
"Ommatidae",
"Oonopidae",
"Opetiidae",
"Opilioacarida",
"Opiliones",
"Opomyzidae",
"Opostegidae",
"Oreogetonidae",
"Ormyridae",
"Orsodacnidae",
"Orsolobidae",
"Ortheziidae",
"Orthoptera",
"Orussidae",
"Oxycarenidae",
"Oxyopidae",
"Oxypeltidae",
"Pachygronthidae",
"Pachyneuridae",
"Pachytroctidae",
"Pacullidae",
"Palaephatidae",
"Pallopteridae",
"Palpigradi",
"Palpimanidae",
"Pamphiliidae",
"Pantophthalmidae",
"Papilionidae",
"Paracaeciliidae",
"Paraleucopidae",
"Paraphrynoveliidae",
"Parastrachiidae",
"Paratropididae",
"Passalidae",
"Passandridae",
"Pediciidae",
"Pedicinidae",
"Pediculidae",
"Pelecinidae",
"Pelecorhynchidae",
"Peloridiidae",
"Peltidae",
"Pemphredonidae",
"Penestomidae",
"Pentatomidae",
"Pergidae",
"Periegopidae",
"Perilampidae",
"Peripsocidae",
"Periscelididae",
"Phacopteronidae",
"Phalacridae",
"Phasmatodea",
"Phaudidae",
"Phengodidae",
"Phiditiidae",
"Philanthidae",
"Philodromidae",
"Philopteridae",
"Philotarsidae",
"Phloeidae",
"Phloeostichidae",
"Phloiophilidae",
"Pholcidae",
"Phoridae",
"Phrurolithidae",
"Phycosecidae",
"Phylloxeridae",
"Physoglenidae",
"Phyxelididae",
"Pieridae",
"Piesmatidae",
"Pimoidae",
"Piophilidae",
"Pipunculidae",
"Pisauridae",
"Plataspidae",
"Platygastridae",
"Platypezidae",
"Platystomatidae",
"Plecoptera",
"Plectreuridae",
"Pleidae",
"Plokiophilidae",
"Plumariidae",
"Plutellidae",
"Polleniidae",
"Polyctenidae",
"Polyplacidae",
"Pompilidae",
"Porrhothelidae",
"Potamocoridae",
"Praydidae",
"Priasilphidae",
"Prionoceridae",
"Prionoglarididae",
"Proctotrupidae",
"Prodidactidae",
"Prodidomidae",
"Prodoxidae",
"Promecheilidae",
"Prostomidae",
"Protocucujidae",
"Psechridae",
"Psenidae",
"Psephenidae",
"Pseudobistonidae",
"Pseudocaeciliidae",
"Pseudococcidae",
"Pseudopomyzidae",
"Psilidae",
"Psilodercidae",
"Psilopsocidae",
"Psocidae",
"Psoquillidae",
"Psychidae",
"Psychodidae",
"Psyllidae",
"Psyllipsocidae",
"Pterolonchidae",
"Pteromalidae",
"Pterophoridae",
"Pthiridae",
"Ptiliidae",
"Ptilodactylidae",
"Ptiloneuridae",
"Ptinidae",
"Ptychopteridae",
"Putoidae",
"Pyralidae",
"Pyrgotidae",
"Pyrochroidae",
"Pyrrhocoridae",
"Pythidae",
"Raphidioptera",
"Ratardidae",
"Reduviidae",
"Rentoniidae",
"Rhadalidae",
"Rhagionidae",
"Rhagophthalmidae",
"Rhipiceridae",
"Rhizoecidae",
"Rhopalidae",
"Rhopalosomatidae",
"Rhyparochromidae",
"Rhysodidae",
"Ricaniidae",
"Richardiidae",
"Ricinidae",
"Riodinidae",
"Ripiphoridae",
"Roeslerstammiidae",
"Ropalomeridae",
"Roproniidae",
"Rotoitidae",
"Saldidae",
"Salpingidae",
"Salticidae",
"Sapygidae",
"Sarcophagidae",
"Sarcoptiformes",
"Saturniidae",
"Scarabaeidae",
"Scathophagidae",
"Scatopsidae",
"Scelionidae",
"Scenopinidae",
"Schistonoeidae",
"Schizomida",
"Schizopodidae",
"Schizopteridae",
"Schreckensteiniidae",
"Sciaridae",
"Sciaroidea_incertae_sedis",
"Sciomyzidae",
"Scirtidae",
"Sclerogibbidae",
"Scolebythidae",
"Scoliidae",
"Scorpiones",
"Scraptiidae",
"Scutelleridae",
"Scythrididae",
"Scythropiidae",
"Scytodidae",
"Segestriidae",
"Selenopidae",
"Sematuridae",
"Senoculidae",
"Sepsidae",
"Sesiidae",
"Sicariidae",
"Sierolomorphidae",
"Signiphoridae",
"Silphidae",
"Silvanidae",
"Simaethistidae",
"Simuliidae",
"Siphonaptera",
"Siricidae",
"Smicripidae",
"Solifugae",
"Somabrachyidae",
"Somatiidae",
"Sparasionidae",
"Sparassidae",
"Spercheidae",
"Sphaeritidae",
"Sphaeriusidae",
"Sphaeroceridae",
"Sphecidae",
"Sphindidae",
"Sphingidae",
"Staphylinidae",
"Stathmopodidae",
"Stenocephalidae",
"Stenochilidae",
"Stenopsocidae",
"Stenotrachelidae",
"Stenotritidae",
"Stephanidae",
"Stictococcidae",
"Stiphidiidae",
"Stratiomyidae",
"Strepsiptera",
"Strongylophthalmyiidae",
"Symphytognathidae",
"Synaphridae",
"Synchroidae",
"Synotaxidae",
"Syringogastridae",
"Syrphidae",
"Tabanidae",
"Tachinidae",
"Tanaostigmatidae",
"Tanyderidae",
"Tanypezidae",
"Telemidae",
"Tenebrionidae",
"Tenebrionoidea_incertae_sedis",
"Tenthredinidae",
"Tephritidae",
"Termitaphididae",
"Tessaratomidae",
"Tetrablemmidae",
"Tetracampidae",
"Tetragnathidae",
"Tetratomidae",
"Tettigarctidae",
"Tettigometridae",
"Thanerocleridae",
"Thaumaleidae",
"Thaumastellidae",
"Thaumastocoridae",
"Theraphosidae",
"Therevidae",
"Theridiidae",
"Theridiosomatidae",
"Thomisidae",
"Throscidae",
"Thymalidae",
"Thynnidae",
"Thyreocoridae",
"Thyrididae",
"Thysanoptera",
"Tineidae",
"Tineodidae",
"Tingidae",
"Tiphiidae",
"Tipulidae",
"Tischeriidae",
"Titanoecidae",
"Tonzidae",
"Torridincolidae",
"Tortricidae",
"Torymidae",
"Toxopidae",
"Trachelidae",
"Trachypachidae",
"Trachypetidae",
"Trechaleidae",
"Trichoceridae",
"Trichodectidae",
"Trichogrammatidae",
"Trichopsocidae",
"Trichoptera",
"Trictenotomidae",
"Tridentaformidae",
"Trigonalidae",
"Triozidae",
"Trochanteriidae",
"Troctopsocidae",
"Trogidae",
"Trogiidae",
"Trogloraptoridae",
"Trogossitidae",
"Trombidiformes",
"Tropiduchidae",
"Udubidae",
"Ulidiidae",
"Uloboridae",
"Ulodidae",
"Uraniidae",
"Urodidae",
"Uropygi",
"Urostylididae",
"Ustyurtiidae",
"Vanhorniidae",
"Veliidae",
"Velocipedidae",
"Vermileonidae",
"Vesperidae",
"Vespidae",
"Viridasiidae",
"Xenoctenidae",
"Xiphydriidae",
"Xyelidae",
"Xylomyidae",
"Xylophagidae",
"Xyloryctidae",
"Yponomeutidae",
"Ypsolophidae",
"Zodariidae",
"Zopheridae",
"Zoraptera",
"Zoropsidae",
"Zygaenidae",
"Zygentoma")

# args <- commandArgs()
# order <- args[6]
# print(order)

for (i in seq_along(order)){
    x <- order[i]
    print(x)
    # Commands to get the data from the website BOLD Systems

    a <- as.data.frame(
        bold_seqspec(taxon = x,
        marker = "COI",
        format = "tsv",
        sepfasta = FALSE)
        )

    # Getting rid of the unwanted information

    a <- a %>%
        select(- c(recordID,
        catalognum,
        fieldnum,
        institution_storing,
        collection_code,
        bin_uri,
        phylum_taxID,
        class_taxID,
        order_taxID,
        family_taxID,
        subfamily_taxID,
        subfamily_name,
        genus_taxID,
        subspecies_taxID,
        subspecies_name,
        identification_provided_by,
        identification_method,
        identification_reference,
        tax_note,
        voucher_status,
        tissue_type,
        collection_event_id,
        collectors,
        collectiondate_start,
        collectiondate_end,
        collectiontime,
        collection_note,
        site_code,
        sampling_protocol,
        lifestage,
        sex,
        reproduction,
        habitat,
        associated_specimens,
        associated_taxa,
        extrainfo,
        notes,
        lat,
        lon,
        coord_source,
        coord_accuracy,
        elev,
        depth,
        elev_accuracy,
        depth_accuracy,
        country,
        province_state,
        region,
        sector,
        exactsite,
        image_ids,
        image_urls,
        media_descriptors,
        captions,
        copyright_holders,
        copyright_years,
        copyright_licenses,
        copyright_institutions,
        photographers,
        sequenceID,
        trace_ids,
        trace_names,
        trace_links,
        run_dates,
        sequencing_centers,
        directions,
        seq_primers,
        marker_codes,
        genbank_accession)) %>%
        mutate(Provenance = "BOLD",
        Molecular_data = paste0(sampleid, "_", markercode),
        Seq_length = nchar(nucleotides)) %>%
        select(- markercode) %>%
        # Renaming the columns for them to be compatible
        # with the ARTHEMIS database
        rename(Specimen_code = processid,
            Specimen_ID = sampleid,
            Class = class_name,
            Phylum = phylum_name,
            Order = order_name,
            Family = family_name,
            Genus = genus_name,
            Species = species_name,
            Sequence = nucleotides,
            Taxon_name_id = species_taxID)


    # Exporting the data as a table

    filename <- file.path("./database/Orders", paste0("Order", "_", x, ".csv"))
    write.table(a,
    file = filename,
    sep = ";",
    na = "NA",
    dec = ".",
    row.names = FALSE,
    col.names = TRUE)
    print("ok")
}
